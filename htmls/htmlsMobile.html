<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Editor HTML + AI (Mobile + Eruda)</title>
  <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'><text y='1.2em' font-size='90'>üöÄ</text></svg>">

  <script type="importmap">
  {
    "imports": {
      "react": "https://esm.sh/react@19.2.0",
      "react-dom/client": "https://esm.sh/react-dom@19.2.0/client",
      "@google/genai": "https://esm.sh/@google/genai@1.34.0"
    }
  }
  </script>

  <style>
    :root{
      --bg-main:#101014;
      --bg-panel:#17171c;
      --bg-header:#111117;
      --border:#23232e;
      --accent:#6366f1;
      --accent-hover:#4f46e5;
      --text-main:#e9e9ed;
      --text-muted:#9ca3af;
      --success:#10b981;
      --danger:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{width:100%;height:100%;margin:0;padding:0;overflow:hidden;font-family:Inter,Segoe UI,sans-serif;background:var(--bg-main);color:var(--text-main);}
    #root{display:flex;flex-direction:column;height:100dvh;height:100vh;}

    .header{
      background:var(--bg-header);
      padding:0 calc(14px + env(safe-area-inset-right)) 0 calc(14px + env(safe-area-inset-left));
      border-bottom:1px solid var(--border);
      display:flex;justify-content:space-between;align-items:center;height:60px;flex-shrink:0;gap:10px;
    }
    .header h1{font-size:15px;margin:0;font-weight:800;display:flex;align-items:center;gap:8px;white-space:nowrap;}
    .header-right{display:flex;gap:10px;align-items:center;min-width:0;}

    .main-container{flex:1;display:flex;height:calc(100dvh - 60px);height:calc(100vh - 60px);overflow:hidden;position:relative;}

    .editor-section{
      width:50%;
      display:flex;flex-direction:column;background:var(--bg-panel);
      border-right:1px solid var(--border);min-width:320px;
    }
    .preview-section{flex:1;background:#fff;display:flex;flex-direction:column;position:relative;}

    .controls-panel{
      padding:12px;
      background:var(--bg-header);
      border-bottom:1px solid var(--border);
      display:flex;gap:8px;align-items:flex-end;flex-wrap:wrap;
    }
    .input-group{display:flex;flex-direction:column;gap:4px;flex:1;min-width:170px;}
    .input-group label{font-size:11px;color:var(--text-muted);font-weight:700;text-transform:uppercase;}

    input[type="text"], input[type="password"]{
      background:var(--bg-main);
      border:1px solid var(--border);
      color:var(--text-main);
      padding:8px 12px;border-radius:8px;outline:none;
      font-size:16px; /* evita zoom iOS */
      height:40px;width:100%;
    }
    input[type="text"]:focus, input[type="password"]:focus{border-color:var(--accent);}

    .btn{
      padding:0 14px;border-radius:10px;border:none;font-weight:800;
      cursor:pointer;font-size:13px;transition:all .2s;height:40px;
      display:flex;align-items:center;justify-content:center;gap:8px;
      white-space:nowrap;user-select:none;
      touch-action:manipulation;
      min-width:44px; /* alvo touch */
    }
    .btn:disabled{opacity:.55;cursor:not-allowed;}
    .btn-primary{background:var(--accent);color:#fff;}
    .btn-primary:hover:not(:disabled){background:var(--accent-hover);}
    .btn-ai{
      background:linear-gradient(135deg,#6366f1 0%,#a855f7 100%);
      color:#fff;border:1px solid rgba(255,255,255,.12);
    }
    .btn-ai:hover{filter:brightness(1.08);}
    .btn-secondary{background:#2d2d3a;color:var(--text-muted);border:1px solid var(--border);}
    .btn-secondary:hover{color:var(--text-main);border-color:rgba(255,255,255,.25);}

    .tabs{display:flex;background:var(--bg-header);border-bottom:1px solid var(--border);}
    .tab{flex:1;padding:10px;text-align:center;cursor:pointer;font-size:12px;font-weight:800;color:var(--text-muted);border-right:1px solid var(--border);background:transparent;transition:all .2s;}
    .tab:last-child{border-right:none;}
    .tab.active{background:var(--bg-panel);color:var(--accent);border-bottom:2px solid var(--accent);}
    .tab:hover:not(.active){color:var(--text-main);background:#1c1c24;}

    .editor-container{flex:1;position:relative;overflow:hidden;}
    textarea.code-area{
      width:100%;height:100%;
      background:var(--bg-panel);color:#e9e9ed;border:none;
      padding:14px;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Fira Code",monospace;
      font-size:16px;line-height:1.5;resize:none;outline:none;
    }

    .file-manager{
      height:200px;background:#0d0d11;display:flex;flex-direction:column;border-top:1px solid var(--border);
    }
    .fm-header{
      padding:8px 12px;display:flex;justify-content:space-between;align-items:center;background:#141419;border-bottom:1px solid var(--border);
    }
    .fm-header span{font-size:11px;font-weight:900;text-transform:uppercase;color:var(--text-muted);}
    .file-list{flex:1;overflow:auto;padding:0;margin:0;list-style:none;}
    .file-item{padding:8px 12px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #1f1f28;transition:background .1s;}
    .file-item:hover{background:#1c1c24;}
    .file-info{display:flex;flex-direction:column;cursor:pointer;flex:1;min-width:0;}
    .file-name{font-size:13px;color:var(--accent);font-weight:700;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
    .file-actions{display:flex;gap:6px;}
    .btn-icon{padding:4px;border-radius:6px;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;width:32px;height:32px;}
    .btn-del{background:#3a1d1d;color:#fca5a5;}

    iframe{width:100%;height:100%;border:none;background:#fff;}

    .modal-overlay{
      position:fixed;inset:0;background:rgba(0,0,0,.72);backdrop-filter:blur(4px);
      display:flex;align-items:center;justify-content:center;z-index:1000;
      padding:14px;
    }
    .modal-content{
      background:#1c1c24;border:1px solid var(--border);
      width:min(720px,100%);border-radius:14px;
      padding:18px;box-shadow:0 20px 50px rgba(0,0,0,.5);
      display:flex;flex-direction:column;gap:12px;
      max-height:min(90dvh,90vh);overflow:auto;
    }
    .modal-title{font-size:18px;font-weight:900;color:#fff;display:flex;align-items:center;gap:8px;}
    .modal-textarea{
      width:100%;height:140px;background:#111116;border:1px solid var(--border);
      border-radius:10px;color:#fff;padding:12px;font-size:15px;resize:none;outline:none;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }
    .modal-textarea:focus{border-color:var(--accent);}
    .modal-actions{display:flex;justify-content:flex-end;gap:10px;margin-top:4px;flex-wrap:wrap;}

    .status-bar{padding:8px 14px;border-radius:999px;font-size:13px;font-weight:800;box-shadow:0 4px 12px rgba(0,0,0,.3);max-width:60vw;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
    .status-info{background:#3b82f6;color:#fff;}
    .status-success{background:var(--success);color:#fff;}
    .status-error{background:var(--danger);color:#fff;}

    .spinner{
      width:16px;height:16px;border:2px solid rgba(255,255,255,.3);
      border-radius:50%;border-top-color:#fff;animation:spin 1s linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg)}}

    /* Mobile: vira ‚Äúum painel por vez‚Äù + toggle no header */
    .mobile-toggle{display:none;}
    @media (max-width: 860px){
      body{overflow:hidden;}
      .main-container{flex-direction:column;}
      .editor-section,.preview-section{width:100%;height:100%;min-width:0;}
      .editor-section{border-right:none;}
      .file-manager{display:none;} /* no mobile some por padr√£o */
      .mobile-toggle{display:flex;gap:8px;align-items:center;}
      .header h1{font-size:14px;}
      .controls-panel{position:sticky;top:0;z-index:2;}
    }
    /* Controlado por classe para alternar */
    .is-mobile .editor-section{display:flex;}
    .is-mobile .preview-section{display:flex;}
    .is-mobile.mobile-show-editor .preview-section{display:none;}
    .is-mobile.mobile-show-preview .editor-section{display:none;}
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="module">
    import React, { useEffect, useMemo, useRef, useState } from "react";
    import { createRoot } from "react-dom/client";
    import { GoogleGenAI, Type } from "@google/genai";

    const DEFAULT_SETTINGS = {
      githubToken: "",
      githubOwner: "",
      githubRepo: "",
      githubPath: "htmls",
      githubBranch: "main",
      geminiApiKey: ""
    };
    const STORAGE_KEY = "htmls_site_settings_v2_mobile_eruda";

    class GitHubService {
      constructor(settings){ this.settings = settings; }
      updateSettings(newSettings){ this.settings = newSettings; }
      get headers(){
        return {
          "Authorization": `Bearer ${this.settings.githubToken}`,
          "Accept": "application/vnd.github+json",
          "Content-Type": "application/json"
        };
      }
      get isConfigured(){
        return !!(this.settings.githubToken && this.settings.githubOwner && this.settings.githubRepo);
      }
      async listFiles(){
        if(!this.isConfigured) return [];
        const url = `https://api.github.com/repos/${this.settings.githubOwner}/${this.settings.githubRepo}/contents/${this.settings.githubPath}?ref=${this.settings.githubBranch}`;
        const res = await fetch(url,{headers:this.headers});
        if(!res.ok){
          if(res.status===404) return [];
          throw new Error(`GitHub Error: ${res.statusText}`);
        }
        const files = await res.json();
        if(!Array.isArray(files)) return [];
        return files.filter(f=>f.name.endsWith(".html")).sort((a,b)=>a.name.localeCompare(b.name));
      }
      async getFile(filename){
        const url = `https://api.github.com/repos/${this.settings.githubOwner}/${this.settings.githubRepo}/contents/${this.settings.githubPath}/${filename}?ref=${this.settings.githubBranch}`;
        const res = await fetch(url,{headers:this.headers});
        if(!res.ok) throw new Error("Arquivo n√£o encontrado");
        const data = await res.json();
        const content = new TextDecoder().decode(
          Uint8Array.from(atob(data.content.replace(/\s/g,"")), c=>c.charCodeAt(0))
        );
        return { content, sha: data.sha };
      }
      async saveFile(filename, content){
        const path = `${this.settings.githubPath}/${filename}`;
        const url = `https://api.github.com/repos/${this.settings.githubOwner}/${this.settings.githubRepo}/contents/${path}`;
        let sha = null;
        try { sha = (await this.getFile(filename)).sha; } catch(_){}
        const encoded = btoa(String.fromCharCode(...new TextEncoder().encode(content)));
        const body = {
          message: `Update ${filename} via HTML Editor`,
          content: encoded,
          branch: this.settings.githubBranch,
          ...(sha ? { sha } : {})
        };
        const res = await fetch(url,{method:"PUT",headers:this.headers,body:JSON.stringify(body)});
        if(!res.ok){
          let err = {};
          try{ err = await res.json(); }catch(_){}
          throw new Error(err.message || "Erro ao salvar no GitHub");
        }
        return await res.json();
      }
      async deleteFile(filename){
        const file = await this.getFile(filename);
        const url = `https://api.github.com/repos/${this.settings.githubOwner}/${this.settings.githubRepo}/contents/${this.settings.githubPath}/${filename}`;
        const res = await fetch(url,{
          method:"DELETE",
          headers:this.headers,
          body:JSON.stringify({message:`Delete ${filename}`, sha:file.sha, branch:this.settings.githubBranch})
        });
        if(!res.ok) throw new Error("Erro ao deletar");
      }
    }

    function isMobileNow(){
      return window.matchMedia && window.matchMedia("(max-width: 860px)").matches;
    }

    function App(){
      const [html,setHtml] = useState("<h1>Ol√° Mundo!</h1>");
      const [css,setCss] = useState("body{font-family:system-ui;padding:20px;background:#f0f0f0} h1{color:#333}");
      const [js,setJs] = useState('console.log("P√°gina carregada");');
      const [activeTab,setActiveTab] = useState("html");
      const [filename,setFilename] = useState("index.html");
      const [files,setFiles] = useState([]);
      const [status,setStatus] = useState(null);
      const [isSaving,setIsSaving] = useState(false);
      const [isAIGenerating,setIsAIGenerating] = useState(false);
      const [showAIModal,setShowAIModal] = useState(false);
      const [showSettingsModal,setShowSettingsModal] = useState(false);
      const [aiPrompt,setAiPrompt] = useState("");
      const [isFullMode,setIsFullMode] = useState(false);

      const [settings,setSettings] = useState(DEFAULT_SETTINGS);
      const [ghService,setGhService] = useState(new GitHubService(DEFAULT_SETTINGS));

      const iframeRef = useRef(null);

      const [isMobile,setIsMobile] = useState(isMobileNow());
      const [mobilePane,setMobilePane] = useState("editor"); // editor | preview

      useEffect(()=>{
        const onResize = ()=>{
          const m = isMobileNow();
          setIsMobile(m);
          if(!m) setMobilePane("editor");
        };
        window.addEventListener("resize", onResize, {passive:true});
        return ()=>window.removeEventListener("resize", onResize);
      },[]);

      // aplica classes no <body> pra controlar layout mobile
      useEffect(()=>{
        document.body.classList.toggle("is-mobile", isMobile);
        document.body.classList.toggle("mobile-show-editor", isMobile && mobilePane==="editor");
        document.body.classList.toggle("mobile-show-preview", isMobile && mobilePane==="preview");
      },[isMobile,mobilePane]);

      const showStatus = (msg,type="info")=>{
        setStatus({msg,type});
        setTimeout(()=>setStatus(null), 3500);
      };

      useEffect(()=>{
        const saved = localStorage.getItem(STORAGE_KEY);
        if(saved){
          try{
            const parsed = JSON.parse(saved);
            setSettings(parsed);
            const service = new GitHubService(parsed);
            setGhService(service);
            if(parsed.githubToken){
              service.listFiles().then(setFiles).catch(err=>{
                console.error(err);
                showStatus("Erro ao listar arquivos. Verifique as configura√ß√µes.","error");
              });
            }else{
              setShowSettingsModal(true);
            }
          }catch(e){
            console.error(e);
            setShowSettingsModal(true);
          }
        }else{
          setShowSettingsModal(true);
        }
      },[]);

      const refreshFileList = async ()=>{
        try{ setFiles(await ghService.listFiles()); }
        catch(e){ showStatus("Erro na lista: "+e.message,"error"); }
      };

      const toggleMode = ()=>{
        if(isFullMode){
          const parser = new DOMParser();
          const doc = parser.parseFromString(html,"text/html");
          const styleTag = doc.querySelector("head style");
          const extractedCss = styleTag ? styleTag.innerHTML.trim() : "";
          if(styleTag) styleTag.remove();
          const scripts = doc.querySelectorAll("body script");
          let extractedJs = "";
          scripts.forEach(s=>{
            if(s.innerHTML.trim()){
              extractedJs += s.innerHTML.trim() + "\n";
              s.remove();
            }
          });
          setCss(extractedCss);
          setJs(extractedJs.trim());
          setHtml(doc.body ? doc.body.innerHTML.trim() : "");
          setIsFullMode(false);
          setActiveTab("html");
          showStatus("Modo: Abas separadas","info");
        }else{
          const full = `<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${filename}</title>
  <style>
${css}
  </style>
</head>
<body>
${html}
  <script>
${js}
  <\/script>
</body>
</html>`;
          setHtml(full);
          setCss("");
          setJs("");
          setIsFullMode(true);
          showStatus("Modo: Arquivo completo","info");
        }
      };

      const handleSaveSettings = (newSettings)=>{
        setSettings(newSettings);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(newSettings));
        const service = new GitHubService(newSettings);
        setGhService(service);
        setShowSettingsModal(false);
        showStatus("Configura√ß√µes salvas!","success");
        service.listFiles()
          .then(list=>{ setFiles(list); showStatus("Conectado ao GitHub","success"); })
          .catch(e=> showStatus("Erro ao conectar GitHub: "+e.message,"error"));
      };

      const handleLoadFile = async (fname)=>{
        showStatus(`Carregando ${fname}...`,"info");
        try{
          const data = await ghService.getFile(fname);
          setFilename(fname);

          const content = data.content;
          if(content.includes("<html") && content.includes("</html>")){
            try{
              const parser = new DOMParser();
              const doc = parser.parseFromString(content,"text/html");
              const styleTag = doc.querySelector("head style");
              setCss(styleTag ? styleTag.innerHTML.trim() : "");
              if(styleTag) styleTag.remove();
              const scripts = doc.querySelectorAll("body script");
              let jsContent = "";
              scripts.forEach(s=>{
                if(s.innerHTML.trim()){
                  jsContent += s.innerHTML.trim() + "\n";
                  s.remove();
                }
              });
              setJs(jsContent.trim());
              setHtml(doc.body.innerHTML.trim());
              setIsFullMode(false);
            }catch(_){
              setHtml(content);
              setIsFullMode(true);
            }
          }else{
            setHtml(content);
            setCss("");
            setJs("");
            setIsFullMode(false);
          }
          showStatus("Arquivo carregado","success");
          if(isMobile) setMobilePane("editor");
        }catch(e){
          showStatus(e.message,"error");
        }
      };

      const handleSave = async ()=>{
        if(!ghService.isConfigured){
          setShowSettingsModal(true);
          return;
        }
        if(!filename.endsWith(".html")){
          showStatus("O nome deve terminar em .html","error");
          return;
        }
        setIsSaving(true);
        try{
          let fullContent;
          if(isFullMode){
            fullContent = html;
          }else{
            fullContent = `<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${filename}</title>
  <style>
${css}
  </style>
</head>
<body>
${html}
  <script>
${js}
  <\/script>
</body>
</html>`;
          }
          await ghService.saveFile(filename, fullContent);
          showStatus("Salvo com sucesso!","success");
          refreshFileList();
        }catch(e){
          showStatus(e.message,"error");
        }finally{
          setIsSaving(false);
        }
      };

      const handleDelete = async (fname)=>{
        if(!confirm(`Apagar ${fname}?`)) return;
        try{
          await ghService.deleteFile(fname);
          showStatus("Arquivo deletado","success");
          refreshFileList();
        }catch(e){
          showStatus(e.message,"error");
        }
      };

      const handleNew = ()=>{
        setFilename("nova-pagina.html");
        setHtml("<h1>Nova P√°gina</h1>");
        setCss("body{padding:20px;font-family:system-ui}");
        setJs("");
        setIsFullMode(false);
        showStatus("Novo projeto iniciado","info");
        if(isMobile) setMobilePane("editor");
      };

      // injeta Eruda no preview (iframe) quando:
      // - URL tiver ?eruda, OU
      // - estiver em mobile
      const erudaSnippetForIframe = useMemo(()=>{
        return `
<script>
(function(){
  try{
    var params = new URLSearchParams(parent.location.search);
    var force = params.has("eruda") || params.has("debug");
    var mobile = /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
    if(!force && !mobile) return;
    var s=document.createElement("script");
    s.src="https://cdn.jsdelivr.net/npm/eruda";
    s.onload=function(){ try{ eruda && eruda.init(); }catch(e){} };
    document.head.appendChild(s);
  }catch(e){}
})();
<\/script>`;
      },[]);

      // atualiza preview com debounce mais ‚Äúleve‚Äù no mobile
      useEffect(()=>{
        const delay = isMobile ? 1200 : 700;
        const t = setTimeout(()=>{
          if(!iframeRef.current) return;

          let doc;
          if(isFullMode){
            // se for modo arquivo completo, tenta injetar o Eruda no final do <head> se existir
            // (sem quebrar se o user j√° tiver Eruda)
            if((new URLSearchParams(location.search)).has("eruda") || isMobile){
              // injeta s√≥ se n√£o achar 'eruda.init' no conte√∫do
              if(!/eruda\.init\(/i.test(html)){
                doc = html.replace(/<\/head>/i, `${erudaSnippetForIframe}\n</head>`);
              }else{
                doc = html;
              }
            }else{
              doc = html;
            }
          }else{
            doc = `<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>${css}</style>
  ${erudaSnippetForIframe}
</head>
<body>
  ${html}
  <script>${js}<\/script>
</body>
</html>`;
          }

          iframeRef.current.srcdoc = doc;
        }, delay);
        return ()=>clearTimeout(t);
      },[html,css,js,isFullMode,isMobile,erudaSnippetForIframe]);

      const handleAIGenerate = async ()=>{
        if(!settings.geminiApiKey){
          showStatus("Configure a API Key do Gemini nas configura√ß√µes!","error");
          setShowSettingsModal(true);
          return;
        }
        if(!aiPrompt.trim()) return;

        setIsAIGenerating(true);
        setShowAIModal(false);
        showStatus("Gemini est√° pensando...","info");
        try{
          const ai = new GoogleGenAI({ apiKey: settings.geminiApiKey });
          const prompt = `Create a single HTML file website based on this request: "${aiPrompt}".\nReturn JSON with: html (body only), css, javascript. Make it responsive.`;
          const response = await ai.models.generateContent({
            model: "gemini-3-flash-preview",
            contents: prompt,
            config: {
              responseMimeType: "application/json",
              responseSchema: {
                type: Type.OBJECT,
                properties: {
                  html: { type: Type.STRING },
                  css: { type: Type.STRING },
                  javascript: { type: Type.STRING }
                },
                required: ["html","css","javascript"]
              }
            }
          });
          const jsonStr = response.text;
          const data = JSON.parse(jsonStr);

          setHtml(data.html || "");
          setCss(data.css || "");
          setJs(data.javascript || "");
          setIsFullMode(false);
          showStatus("P√°gina gerada com sucesso!","success");
          if(isMobile) setMobilePane("editor");
        }catch(e){
          console.error(e);
          showStatus("Erro ao gerar com IA: " + e.message, "error");
        }finally{
          setIsAIGenerating(false);
          setAiPrompt("");
        }
      };

      const openCurrentPage = ()=>{
        const PUBLIC_PREFIX="/htmls/";
        let cleanName = filename.trim();
        if(!cleanName){ showStatus("Defina um nome de arquivo primeiro.","error"); return; }
        if(cleanName.endsWith(".html")) cleanName = cleanName.slice(0,-5);
        const url = `${PUBLIC_PREFIX}${cleanName}`;
        window.open(url,"_blank","noopener,noreferrer");
        showStatus(`Abrindo ${url}`,"info");
      };

      return (
        React.createElement("div",{id:"app"},
          React.createElement("div",{className:"header"},
            React.createElement("h1",null,"üöÄ Editor HTML"),
            React.createElement("div",{className:"header-right"},
              isMobile && React.createElement("div",{className:"mobile-toggle"},
                React.createElement("button",{
                  className:"btn btn-secondary",
                  onClick:()=>setMobilePane("editor"),
                  title:"Editor"
                },"üß© Editor"),
                React.createElement("button",{
                  className:"btn btn-secondary",
                  onClick:()=>setMobilePane("preview"),
                  title:"Preview"
                },"üëÅÔ∏è Preview")
              ),
              status && React.createElement("div",{
                className:`status-bar status-${status.type}`
              }, status.msg),
              React.createElement("button",{
                className:"btn btn-secondary",
                onClick:()=>setShowSettingsModal(true),
                title:"Configura√ß√µes"
              },"‚öôÔ∏è")
            )
          ),

          React.createElement("div",{className:"main-container"},
            React.createElement("div",{className:"editor-section"},
              React.createElement("div",{className:"controls-panel"},
                React.createElement("div",{className:"input-group"},
                  React.createElement("label",null,"Nome do Arquivo"),
                  React.createElement("input",{
                    type:"text",
                    value:filename,
                    onChange:e=>setFilename(e.target.value),
                    placeholder:"ex: sitescriado.html"
                  })
                ),
                React.createElement("button",{
                  className:"btn btn-ai",
                  onClick:()=>setShowAIModal(true),
                  disabled:isAIGenerating
                }, isAIGenerating ? React.createElement("div",{className:"spinner"}) : "‚ú® IA"),
                React.createElement("button",{
                  className:"btn btn-secondary",
                  onClick:toggleMode,
                  title:"Alternar Visualiza√ß√£o"
                }, isFullMode ? "üìë Dividir" : "üìÑ Unir"),
                React.createElement("button",{className:"btn btn-secondary",onClick:handleNew},"üìÑ Novo"),
                React.createElement("button",{
                  className:"btn btn-primary",
                  onClick:handleSave,
                  disabled:isSaving
                }, isSaving ? "..." : "‚òÅÔ∏è Salvar"),
                React.createElement("button",{
                  className:"btn btn-secondary",
                  onClick:openCurrentPage,
                  title:"Abrir p√°gina publicada em /htmls/"
                },"üåê Abrir")
              ),

              !isFullMode && React.createElement("div",{className:"tabs"},
                React.createElement("div",{className:`tab ${activeTab==="html"?"active":""}`,onClick:()=>setActiveTab("html")},"HTML"),
                React.createElement("div",{className:`tab ${activeTab==="css"?"active":""}`,onClick:()=>setActiveTab("css")},"CSS"),
                React.createElement("div",{className:`tab ${activeTab==="js"?"active":""}`,onClick:()=>setActiveTab("js")},"JS")
              ),

              React.createElement("div",{className:"editor-container"},
                isFullMode
                  ? React.createElement("textarea",{
                      className:"code-area",
                      value:html,
                      onChange:e=>setHtml(e.target.value),
                      placeholder:"<!-- C√≥digo HTML Completo -->"
                    })
                  : React.createElement(React.Fragment,null,
                      activeTab==="html" && React.createElement("textarea",{
                        className:"code-area",
                        value:html,
                        onChange:e=>setHtml(e.target.value),
                        placeholder:"<!-- HTML (dentro do body) -->"
                      }),
                      activeTab==="css" && React.createElement("textarea",{
                        className:"code-area",
                        value:css,
                        onChange:e=>setCss(e.target.value),
                        placeholder:"/* CSS */"
                      }),
                      activeTab==="js" && React.createElement("textarea",{
                        className:"code-area",
                        value:js,
                        onChange:e=>setJs(e.target.value),
                        placeholder:"// JavaScript"
                      })
                    ),
                isAIGenerating && React.createElement("div",{
                  style:{
                    position:"absolute",inset:0,background:"rgba(0,0,0,0.82)",
                    display:"flex",alignItems:"center",justifyContent:"center",
                    color:"white",flexDirection:"column",gap:"12px",zIndex:10
                  }
                },
                  React.createElement("div",{className:"spinner",style:{width:42,height:42}}),
                  React.createElement("p",null,"Gerando com Gemini...")
                )
              ),

              React.createElement("div",{className:"file-manager"},
                React.createElement("div",{className:"fm-header"},
                  React.createElement("span",null, settings.githubRepo ? `${settings.githubRepo}/${settings.githubPath}` : "Arquivos Remotos"),
                  React.createElement("button",{className:"btn-icon btn-secondary",onClick:refreshFileList},"‚Üª")
                ),
                React.createElement("ul",{className:"file-list"},
                  files.length===0 && React.createElement("li",{style:{padding:"18px",textAlign:"center",color:"#666"}}, "Nenhum arquivo ou n√£o conectado."),
                  files.map(f =>
                    React.createElement("li",{key:f.name,className:"file-item"},
                      React.createElement("div",{className:"file-info",onClick:()=>handleLoadFile(f.name)},
                        React.createElement("span",{className:"file-name"}, f.name)
                      ),
                      React.createElement("div",{className:"file-actions"},
                        React.createElement("button",{
                          className:"btn-icon btn-del",
                          onClick:e=>{e.stopPropagation(); handleDelete(f.name);},
                          title:"Apagar"
                        },"üóëÔ∏è")
                      )
                    )
                  )
                )
              )
            ),

            React.createElement("div",{className:"preview-section"},
              React.createElement("iframe",{ref:iframeRef,title:"Preview"})
            )
          ),

          showAIModal && React.createElement("div",{className:"modal-overlay",onClick:()=>setShowAIModal(false)},
            React.createElement("div",{className:"modal-content",onClick:e=>e.stopPropagation()},
              React.createElement("div",{className:"modal-title"},"‚ú® Criar P√°gina com IA"),
              React.createElement("textarea",{
                className:"modal-textarea",
                placeholder:"Descreva a p√°gina... ex: 'Landing page para pizzaria com tema escuro e formul√°rio de pedido'",
                value:aiPrompt,
                onChange:e=>setAiPrompt(e.target.value),
                autoFocus:true
              }),
              React.createElement("div",{className:"modal-actions"},
                React.createElement("button",{className:"btn btn-secondary",onClick:()=>setShowAIModal(false)},"Cancelar"),
                React.createElement("button",{className:"btn btn-ai",onClick:handleAIGenerate},"Gerar")
              )
            )
          ),

          showSettingsModal && React.createElement("div",{className:"modal-overlay",style:{zIndex:2000}},
            React.createElement("div",{className:"modal-content"},
              React.createElement("div",{className:"modal-title"},"‚öôÔ∏è Configura√ß√µes"),
              React.createElement("p",{style:{fontSize:"12px",color:"#9aa",margin:0}},"Fica salvo apenas no seu navegador."),
              React.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"}},
                React.createElement("div",{className:"input-group"},
                  React.createElement("label",null,"GitHub Owner"),
                  React.createElement("input",{type:"text",value:settings.githubOwner,onChange:e=>setSettings({...settings,githubOwner:e.target.value}),placeholder:"ex: theweewee"})
                ),
                React.createElement("div",{className:"input-group"},
                  React.createElement("label",null,"Reposit√≥rio"),
                  React.createElement("input",{type:"text",value:settings.githubRepo,onChange:e=>setSettings({...settings,githubRepo:e.target.value}),placeholder:"ex: htmls.site"})
                ),
                React.createElement("div",{className:"input-group"},
                  React.createElement("label",null,"Pasta (Path)"),
                  React.createElement("input",{type:"text",value:settings.githubPath,onChange:e=>setSettings({...settings,githubPath:e.target.value}),placeholder:"ex: htmls"})
                ),
                React.createElement("div",{className:"input-group"},
                  React.createElement("label",null,"Branch"),
                  React.createElement("input",{type:"text",value:settings.githubBranch,onChange:e=>setSettings({...settings,githubBranch:e.target.value}),placeholder:"ex: main"})
                )
              ),
              React.createElement("div",{className:"input-group"},
                React.createElement("label",null,"GitHub Token (repo scope)"),
                React.createElement("input",{type:"password",value:settings.githubToken,onChange:e=>setSettings({...settings,githubToken:e.target.value}),placeholder:"ghp_..."})
              ),
              React.createElement("div",{className:"input-group"},
                React.createElement("label",null,"Gemini API Key"),
                React.createElement("input",{type:"password",value:settings.geminiApiKey,onChange:e=>setSettings({...settings,geminiApiKey:e.target.value}),placeholder:"AIza..."}),
                React.createElement("small",{style:{fontSize:"11px",color:"#778"}},"Necess√°rio para usar a IA.")
              ),
              React.createElement("div",{className:"modal-actions"},
                React.createElement("button",{className:"btn btn-secondary",onClick:()=>setShowSettingsModal(false)},"Fechar"),
                React.createElement("button",{className:"btn btn-primary",onClick:()=>handleSaveSettings(settings)},"Salvar")
              )
            )
          )
        )
      );
    }

    createRoot(document.getElementById("root")).render(React.createElement(App));
  </script>

  <!-- Eruda no PR√ìPRIO editor (n√£o s√≥ no preview) -->
  <script>
    (function(){
      try{
        var params = new URLSearchParams(location.search);
        var force = params.has("eruda") || params.has("debug");
        var mobile = /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
        if(!force && !mobile) return;
        var s=document.createElement("script");
        s.src="https://cdn.jsdelivr.net/npm/eruda";
        s.onload=function(){ try{ eruda && eruda.init(); }catch(e){} };
        document.head.appendChild(s);
      }catch(e){}
    })();
  </script>
</body>
</html>
